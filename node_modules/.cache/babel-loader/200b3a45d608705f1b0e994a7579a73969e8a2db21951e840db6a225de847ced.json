{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/3C-GRAFFIC/GrowthStage/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/workspace/3C-GRAFFIC/GrowthStage/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/workspace/3C-GRAFFIC/GrowthStage/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/3C-GRAFFIC/GrowthStage/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// CompletionRateChart.js\nimport React,{useState,useEffect}from'react';import axios from'axios';import Chart from'react-apexcharts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CompletionRateChart(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),completionRateData=_useState2[0],setCompletionRateData=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),completionRateChartData=_useState4[0],setCompletionRateChartData=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];useEffect(function(){function fetchAllPages(_x){return _fetchAllPages.apply(this,arguments);}function _fetchAllPages(){_fetchAllPages=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(apiToken){var currentPage,response,data,newCompletionRateData,chartData,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:currentPage=_args.length>1&&_args[1]!==undefined?_args[1]:1;_context.prev=1;_context.next=4;return axios.get(\"https://3c.fluxoti.com/api/v1/campaigns?paused=false&page=\".concat(currentPage,\"&api_token=\").concat(apiToken));case 4:response=_context.sent;data=response.data.data;console.log(\"API Response Data for Completion Rate (Page \".concat(currentPage,\"):\"),data);newCompletionRateData=data.map(function(campaign){return{name:campaign.name,completion_rate:campaign.exit_manual_mode===30?1:0};});console.log(\"Formatted Completion Rate Data (Page \".concat(currentPage,\"):\"),newCompletionRateData);setCompletionRateData(function(prevData){return[].concat(_toConsumableArray(prevData),_toConsumableArray(newCompletionRateData));});// Continue fetching next page if available\nif(response.data.meta.current_page<response.data.meta.last_page){fetchAllPages(apiToken,currentPage+1);}else{// All pages processed, generate chart data\nchartData={series:[{name:'Completion Rate',data:completionRateData.map(function(item){return item.completion_rate;})}],options:{chart:{height:350,type:'bar'},xaxis:{categories:completionRateData.map(function(item){return item.name;})},title:{text:'Completion Rate of Campaigns',align:'center'}}};console.log('Completion Rate Chart Data:',chartData);setCompletionRateChartData(chartData);setLoading(false);}_context.next=18;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.error('Error fetching completion rate data:',_context.t0);setError('Error fetching completion rate data. Please try again later.');setLoading(false);case 18:case\"end\":return _context.stop();}},_callee,null,[[1,13]]);}));return _fetchAllPages.apply(this,arguments);}var apiToken='d0NLCpTnvtsY1gQu7S38RyF47fOjnHknynBjGzWxCwpXOJqXaNwWDrGqFomq';fetchAllPages(apiToken);},[completionRateData]);// Adicionando completionRateData como dependência para acionar o fetchAllPages quando ele é atualizado\nif(loading){return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsx(\"p\",{children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid mt-3 mb-3\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Completion Rate of Campaigns\"}),/*#__PURE__*/_jsx(Chart,{options:completionRateChartData.options,series:completionRateChartData.series,type:\"bar\",height:350})]});}export default CompletionRateChart;","map":{"version":3,"names":["React","useState","useEffect","axios","Chart","jsx","_jsx","jsxs","_jsxs","CompletionRateChart","_useState","_useState2","_slicedToArray","completionRateData","setCompletionRateData","_useState3","_useState4","completionRateChartData","setCompletionRateChartData","_useState5","_useState6","loading","setLoading","_useState7","_useState8","error","setError","fetchAllPages","_x","_fetchAllPages","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","apiToken","currentPage","response","data","newCompletionRateData","chartData","_args","wrap","_callee$","_context","prev","next","length","undefined","get","concat","sent","console","log","map","campaign","name","completion_rate","exit_manual_mode","prevData","_toConsumableArray","meta","current_page","last_page","series","item","options","chart","height","type","xaxis","categories","title","text","align","t0","stop","children","className"],"sources":["/workspace/3C-GRAFFIC/GrowthStage/src/components/Completion/CompletionRateChart.js"],"sourcesContent":["// CompletionRateChart.js\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Chart from 'react-apexcharts';\n\nfunction CompletionRateChart() {\n  const [completionRateData, setCompletionRateData] = useState([]);\n  const [completionRateChartData, setCompletionRateChartData] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    async function fetchAllPages(apiToken, currentPage = 1) {\n      try {\n        const response = await axios.get(`https://3c.fluxoti.com/api/v1/campaigns?paused=false&page=${currentPage}&api_token=${apiToken}`);\n\n        const data = response.data.data;\n\n        console.log(`API Response Data for Completion Rate (Page ${currentPage}):`, data);\n\n        const newCompletionRateData = data.map((campaign) => ({\n          name: campaign.name,\n          completion_rate: campaign.exit_manual_mode === 30 ? 1 : 0,\n        }));\n\n        console.log(`Formatted Completion Rate Data (Page ${currentPage}):`, newCompletionRateData);\n\n        setCompletionRateData((prevData) => [...prevData, ...newCompletionRateData]);\n\n        // Continue fetching next page if available\n        if (response.data.meta.current_page < response.data.meta.last_page) {\n          fetchAllPages(apiToken, currentPage + 1);\n        } else {\n          // All pages processed, generate chart data\n          const chartData = {\n            series: [\n              { name: 'Completion Rate', data: completionRateData.map((item) => item.completion_rate) },\n            ],\n            options: {\n              chart: {\n                height: 350,\n                type: 'bar',\n              },\n              xaxis: {\n                categories: completionRateData.map((item) => item.name),\n              },\n              title: {\n                text: 'Completion Rate of Campaigns',\n                align: 'center',\n              },\n            },\n          };\n\n          console.log('Completion Rate Chart Data:', chartData);\n\n          setCompletionRateChartData(chartData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Error fetching completion rate data:', error);\n        setError('Error fetching completion rate data. Please try again later.');\n        setLoading(false);\n      }\n    }\n\n    const apiToken = 'd0NLCpTnvtsY1gQu7S38RyF47fOjnHknynBjGzWxCwpXOJqXaNwWDrGqFomq';\n    fetchAllPages(apiToken);\n  }, [completionRateData]); // Adicionando completionRateData como dependência para acionar o fetchAllPages quando ele é atualizado\n\n  if (loading) {\n    return <p>Loading...</p>;\n  }\n\n  if (error) {\n    return <p>{error}</p>;\n  }\n\n  return (\n    <div className='container-fluid mt-3 mb-3'>\n      <h2>Completion Rate of Campaigns</h2>\n      <Chart\n        options={completionRateChartData.options}\n        series={completionRateChartData.series}\n        type='bar'\n        height={350}\n      />\n    </div>\n  );\n}\n\nexport default CompletionRateChart;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}